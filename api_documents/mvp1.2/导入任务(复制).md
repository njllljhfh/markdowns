# 导入任务（复制任务）

[Url]: 127.0.0.1:8000/training/tasks/duplication



## 1、前端传来的数据

- **`请求类型`**：**POST**

```json
{
    "task_id_old":"2018102439652891014", // 用户选择的历史任务id
    "task_id":"2018102439652891056"  // 新建任务的id
}
```



## 2、返回给前端的数据


```python
// 成功
{
    "code":0,		# 请求成功
    "msg":"复制任务成功",
    "task_type":1,		# 任务类型，取值1，2，3；DL时要用到
    "image_list":[
        {
          "set_type": 0,	# 集合类型 取值 0，1，2;从数据库直接获取的，对应关系查看相应接口
          "img_name":"xxx.jpg",			    # 图片名称
          "img_id":"2018080810000000001",		# 图片ID编号，字符串格式
          "width":2000,					    # 图片宽
          "height":1000,					    # 图片高
          # 后面可能会添加表示图片状态的字段，但是现在先不做处理
          "state":"已标注",					  # 图片状态，分为已标注，已训练，已测试
          "order_id":1,						# 图片序号，从1开始
  		  "mongo_id": "xxxxxxxxxx"
        },
        {
            # ... 第二张图片信息
        }
    ],
    "lab_class_list":[					   # 标签类列表
    	{
    		"id":12,			  		   # 标签类ID
    		"name":"xxx",		  		   # 标签类名
    		"color": "#223344",	 	   	   # 标签类颜色，16进制
    		"order_id":1,				   # 标签类序号，（可以不传，按顺序给就行）
        },
		# 第二个标签类
    ],
}

// 失败
{
    "code": 错误码,
    "msg": "错误信息"
}
```



## 3、逻辑中组织数据用到的关系数据

### 3.1、复制标签类

```python
old_new_lab_class_map = {
                         lab_class_id_old:{
                                             "lab_class_id_new": lab_class_id_new,
                                          }
}
```





### 3.2、复制任务，历史图像id，新图像id，图像的类型id

```python
old_new_img_info_map = {
                        img_id_old:{ # 历史原图id
                                        img_id_new:201898765736526514, # 复制的新原图id
                                        img_roi_id_old:201898765736526513, # 可能没有，给None
                            			img_roi_id_new:201898765736526123, # 可能没有，给None
                            			labeled_img_id_new:201898765736526123,
                                   },
}
```



### 3.3、复制任务，历史roi图像id，对应的，历史原图像id

```python
roi_id_old_img_id_old = {
    						img_roi_id_old:img_id_old,
}
```



### 3.4、新逻辑的map关系

原图id 与新图像信息的关系

```python
old_new_img_info_map =
{
    img_id_old:{ # 历史原图的id
    			"img_id_new":201898765736526123, # 复制的新原图的id
    			"img_roi_id_new":201898765736526123, # 复制的新图的新roi图像的id，(可能没有)
    			"img_roi_id_old":201898765736526513, # 历史原图的roi图像id，(可能没有)
				}
}
```

