# MVP 项目需求





## 一、任务功能

- 创建任务
- 历史人物浏览
- 软件使用帮助

### 1.1、创建任务

任务包含三种类型，分别对应不同的界面和操作流程，由易至难排列如下：

| **分类：** | **框选目标对象并设置类别，用以训练算法模型进行目标对象分类** |
| ---------- | ------------------------------------------------------------ |
| **分割：** | **标注目标对象轮廓，用以训练算法模型实现目标对象与其他区域的分离** |
| **检测：** | **标注目标对象轮廓并设置类别，用以训练算法模型进行目标对象识别** |



### 1.2、历史任务（暂时不做）

#### 1.2.1、需求描述

- 在文件目录中选择已有任务文件打开，进入对应的标注、训练任务



---



## 二、文件功能

###2.1、添加文件

#### 2.1.1、需求描述

- 用户访问本机文件目录，为标注或训练任务选择合适的图像文件素材，系统将用户选择的图像文件素材加载至文件面板。

- 支持拖拽文件加载的交互方式*。
- 支持单个文件加载以及多个文件批量加载。
- 支持图像文件格式：JPEG、PNG、GIF、TIF，后期需要校验图像格式

#### 2.1.2、 



### 2.2、文件分组

#### 2.2.1、需求描述

- 对选中用于进行标注、训练任务的图像文件进行分组。文件分为3个组别，分别为

| **训练集** | **进行图像标注并输入深度学习系统，用于系统进行任务数据学习** |
| ---------- | ------------------------------------------------------------ |
| **测试集** | **使用训练集数据训练出的中间模型，进行算法测试**             |
| **验证集** | **使用最终确定的模型，进行效果验证**                         |

#### 2.2.2、



### 2.3、ROI区域设置（暂时不做）

#### 2.3.1、需求描述

- ROI设置帮助用户将图像文件进行裁剪，将目标区域集中在需要进行标注、训练和识别的特征区域，以提升神经网络的训练精度。
	1. 用户点击ROI设置按钮后，画布加载裁剪工具，并同步显示裁剪区域的大小。
	2. 用户通过拖拽或手工输入裁剪尺寸的方式，设定裁剪区域大小，支持锁定纵横比。
	3. 确定裁剪区域尺寸后，在画布裁剪区域单击鼠标左键，即可完成裁剪。
	4. 支持自由裁剪，即从画布任意区域可以创建一个以某一点为X，以拖动距离为对角线的矩形裁剪框

#### 2.3.2、

### 2.4、文件列表

#### 2.4.1、需求描述

- 读取并逐行列出归属于验证集、训练集、测试集的图像文件。每行显示图像文件序号、文件名、归属该文件的标签数量、当前处理的状态，同时显示当前图像文件集合文件数量和文件总量。

- 图像文件状态根据条件进行匹配，并覆盖前一个状态，具体状态如下：
	1. ready：加载进入系统，但未进行任何操作
	2. 标注：正在或已被作为标注对象执行标注操作
	3. 训练：正在或已经进行深度学习训练操作
	4. 测试：正在或已经进行任务算法测试操作
	5. 验证：正在或已经进行算法模型验证操作

#### 2.4.2、

### 2.5、文件选择

####2.5.1、 需求描述

- 文件支持两种选择方式：

	1. 单选：将光标移动至文件面板中需要选择的图像文件，单击鼠标左键，选中图像文件。
	2. 多选：将光标移动至文件面板中，需要选择的多个图像文件对象的第一个文件，单击鼠标左键后按住键盘左Shift  键，同时将光标移至需要选择的多个图像文件对象的最后一个文件，单击鼠标左键，完成文件多选。***(现在有多选的功能么？)***
	3. 图像文件被选中后，画布加载该图像文件，图像文件根据画布大小自适应等比例缩放，以画布左边为参考标尺。

#### 2.5.2、



### 2.6、删除文件

#### 2.6.1、需求描述

- 未防止误操作，文件删除仅支持以下方式：

	1. 选中单个或多个图像文件后，单击系统界面中的删除文件按钮，进行删除。
	2. 删除作逻辑删除，不删除文件。

#### 2.6.2、

### 2.7、文件保存

#### 2.7.1、需求描述

- 自动保存：在切换至下一个图像文件进行操作前，自动保存对当前文件进行保存。
- 保存内容：
	1. 原图：尺寸数据、像素信息
	2. 标签：每个标签的尺寸、位置、像素信息、标签类

#### 2.7.2、



### 2.8、文件排序

#### 2.8.1、需求描述

- 用户可以对当前图像文件集合做全局性的降序或升序排列操作。

#### 2.8.2、



---



## 三、图像标注

### 3.1、概述

- 通过多种类型标注工具，对图像文件需要进行训练、识别的区域进行标注，标注后形成包含像素位置信息的特征标签，配合标签类功能功能，为神经网络提供训练数据素材。

### 3.2、标注工具

#### 3.2.1、需求描述

- 选择工具：对任意特征标记进行选中操作，一次仅可选中一个特征标记
- 移动工具：对画布加载的图像文件进行上下、左右移动操作。当画布比例>100%的时候有效。
- 直线工具：绘制画布区域中X点至Y点的一条直线
- 曲线工具：追踪画笔轨迹，绘制自有曲线，曲线可闭合形成封闭区域。
- 画圆工具：绘制以当前光标为中心点、鼠标拖动距离为直径的圆形或椭圆形
- 矩形工具：绘制以当前光标位置为X点、鼠标拖动距离为对角线的矩形
- 橡皮工具：移除选中区域当前图层的图像内容。
- 画笔大小：设置画笔线粗参数，1px-7px
- 画布看板：显示画布当前加载图像文件路径、名称、大小、尺寸信息（W、H值），以及鼠标实时位置、画笔显示比例、当前选中的标签。
- 画布操作：用户可对画布进行放大、缩小、撤销、全屏操作。
- 放大：放大画布当前加载图像比例，每次点击放大10%
- 缩小：缩小画布当前加载图像比例，每次点击缩小10%
- 撤销：撤销当前画布最近一次操作，最多撤销3次
- 全屏：全屏显示画布区域



### 3.3、标签类管理

#### 3.3.1、概述与总体流程

- 标签类即标签的类别，是标签的唯一特征，为标签提供对应的描述参数。
- 标签类信息包括：标签类名、特征值。



#### 3.3.2、标签类添加

需求描述：

- 在当前任务中创建标签类，创建后默认标签类名为class+标签类排序，默认特征值为橙色。
- 同一用户组之间的标签，可进行模糊匹配。



####3.3.3、标签类删除（暂时不做）

需求描述：

- 用户可对选中的标签类进行删除操作。同步系统删除数据库中对应的数据。



### 3.4、标签管理（标注实例）

#### 3.4.1、概述和总体流程

- 标签即当前画布加载图像文件中，通过标注工具生成或创建的特征区域数据，包含：标签类、尺寸、位置信息。



#### 3.4.2、创建标签

需求描述：

- 用户每完成一次标注，系统即自动创建一个标签，标签以矢量图层的方式与原图像重叠。



#### 3.4.3、标签列表

需求描述：

- 显示当前已创建的标签列表以及可视状态，用户通过鼠标单击的方式，切换标签可视状态。



#### 3.4.4、删除标签

需求描述：

- 删除标签列表中选中的标签，并同步在画布中移除。



---



## 四、训练组件

### 4.1、训练参数配置

#### 4.1.1、需求描述

根据任务类型的不同，显示对应的训练任务参数配置界面。针对当前的训练集文件数据，用户分别进行数据扩充、训练模型、训练参数以及模型属性的设置，设置完成后提交系统，进行训练操作。

#### 4.1.2、具体训练参数项

- 数据扩充设置

  ​	选择需要对当前训练集数据文件进行扩充操作，非必选项，可多选

- 神经网络模型

  1. 选择训练任务所需要的神经网络模型。根据任务类型的不同，可选的模型范围不同。
  2. 此配置项可设置操作权限等级下限。如对普通用户仅可见，不可选。

- 模型大小

  ​	选择训练任务所需的神经网络性能规模，标准（Normal）或大型（Large )

- Device type 

  ​	配置训练所需的设备，设备类型为CPU或GPU，默认显示GPU。一期只支持GPU。

- Device count

  ​	配置训练所需的设备数量，默认为1，下拉菜单选择。

- Batch Size

  ​	配置神经网络批量大小，即一次放多少图片进入迭代训练。默认10，下拉菜单选择

- Initial learing Rate

  ​	配置初始学习率，默认0.001，下拉选择。

- Maximum iterations

  ​	配置最大迭代次数，默认50000，下拉选择。

- Snapshot interval

  ​	配置模型保存间隙，默认10000，下拉选

- 模型保存名称

  ​	配置模型保存时的名称，用于训练-测试中间过程。



### 4.2、数据扩充

#### 4.2.1、需求描述

当用户可供训练的样本数据文件较少时，可通过使用数据扩充功能，来提升训练数据文件的多样性。

#### 4.2.2、数据扩充当前提供4种类型

4种类型分别是：

- 水平翻转：复制训练数据集当中的图像文件，并对复制后的图像文件进行水平翻转处理
- 垂直翻转：复制训练数据集当中的图像文件，并对复制后的图像文件进行垂直翻转处理
- 90度旋转：复制训练数据集当中的图像文件，并对复制后的图像文件进行90度翻转处理
- 模糊：复制训练数据集当中的图像文件，并对复制后的图像文件进行高斯模糊处理

数据扩充类型支持多选，用户勾选扩充类型后，***系统保存用户选择的扩充类型并***，并调用相关组件进行处理，将处理后的文件以及原始文件作为训练数据文件进行提交。



### 4.3、训练状态面板

#### 4.3.1、需求描述

用户配置完成训练参数并提交后，系统显示训练状态面板，训练状态面板由以下部分组成：

- 训练进度条

  采用百分比进度条方式，展示Tensorflow返回的训练任务处理进度。

- Loss曲线以及实时反馈数据

  采用曲线图的方式，展示Tensorflow返回的实时loss值，并显示实时loss数值以及模型拟合程度。

- 停止按钮

  点击后即停止当前训练任务并保存任务数据。

- 完成按钮

  点击后返回主界面，并显示测试集数据文件以及测试按钮。



---



## 五、测试组件

### 5.1、模型测试配置

需求描述：

使用训练完成的模型测试当前数据集文件，配置相关参数，具体参数项如下：

- 数据集

  选择测试需要的数据集，默认选择当前任务测试集，管理员用户可选择其他数据集。

  

- 测试模型

  选择测试需要的模型，默认选择当前任务训练完成的模型，管理员用户可选择其他模型。



#### 5.2、测试结果面板

需求描述：

- 显示当前任务，测试集测试进度。获取Tensorflow反馈的进度值并以百分比方式显示进度条。

- 使用训练完成的模型，进行数据集测试完成后，系统返回主界面，并将展示各个数据文件的测试结果。包括以下内容：

  1. 原图文件

     - 当前选中测试集文件原图。

  2. 标注笔迹

     - 当前选择测试集文件的用户人工标注笔迹

  3. 测试笔迹

     - 当前选择测试集文件，经过模型测试后，系统产生的标注笔迹，统一以红色呈现。

     - 测试笔迹使用的颜色值将不在标注集中出现。

  4. 置信值

     - 当前选中测试集文件，经过模型测试后，给出的置信值评分。



### 5.3、模型信息面板 

 需求描述

用户可以查看当前测试集使用的模型信息。

模型信息包括以下内容：

- 模型训练参数

  训练时配置的模型训练参数

- 模型评价

  采用ROA或混淆矩阵，显示对当前模型训练和测试的评价。以曲线和具体数值的方式呈现。

- 模型保存设置

  配置模型保存的路径。默认保存名称为任务名。







