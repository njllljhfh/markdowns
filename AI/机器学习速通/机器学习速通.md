# 第一章 特征提取和距离



强人工智能

弱人工智能（现在的人工智能都是弱人工智能）





机器学习能解决的问题，满足以下3点：

1. 规律性
2. 平滑性
3. 结果不变性





特征提取时，会丢失客观事实的很多属性。





One-hot编码：

- 所有的词之间差异都是一样的，丧失了语义
- Multi-hot，丧失了顺序信息
- 浪费存储空间



```
对比下面两种对性别的编码
男:[1]       女:[0]

vs

男:[1,0]   女:[0,1]   (对于性别这种数字化更好)


注意点：性别只有差异，没有大小
```





- 特征向量化没有绝对的好

- 向量和业务（人的理解）契合





即使是同一场景，特征提取也需要看场景本身的数量级





**欧式距离**

- 受量纲（单位）影响

**曼哈顿距离**

**切比雪夫距离**

**闵可夫斯基距离（通用公式）**





实际场景下的距离大多是，流型面：瑞士卷





**Jaccard 距离**：

- 距离=1 - 相似度（交并比）

- 使用场景：例如电商场景
    - 及其稀疏的场景
    - 千万级的商品，大部分的商品都是没有被购买的





**余弦相似度**

- 只考虑向量之间的角度





**内积**

- 未归一化的相似度
- 考虑角度差和长度差





当x，y都是归一化长度的向量，欧氏距离 和 余弦相似度等价，即余弦相似度越大，欧氏距离越小。





**字符串距离**

- 对于等长度字符串，计算 **海明距离** 
    - 不同位的个数
- 对于不等长字符，计算 **编辑距离**
    - 字符串增加一个字符，距离+1
    - 字符串减少一个字符，距离+1
    - 字符串变换一个字符，距离+1

编辑距离的明显缺点是，无法真正衡量语义。







---



# 第二章 线性回归

直接解方程存在的问题：

- 方程过多，方程之间互相矛盾
- 通用性差，大量方程没有解析解
- 机器性能（训练样本上亿的数据，内存放不下）





loss函数

- 凸函数：有最小值





直接求 loss 函数导数等于零的解：

- 通用性差，大量方程没有解析解
- 机器性能（训练样本上亿的数据，内存放不下）





**梯度下降法**（重点）

- 学习因子（是一个超参数，是人工设定的，防止梯度下降的过快）
- 工程上判断loss最小值的，方式
    1. 当  ***w***（权重） 每次迭代变化很小时，说明损失函数 ***loss*** 对 ***w*** 的 偏导数 的值接近于 0
    2. 设置一个足够小的阈值（当loss小于阈值时，停止迭代）





- 训练集：用来学习的数据，参与更新 **w**

- 测试集：不参与训练，只用来评测效果

- 有效集（也叫验证集）：也是一种测试集，但是在训练过程中使用
    - 在训练中用有效集测试 **loss** 如果 有效集 **loss** 开始上升，终止训练。
    - 有效集不参与 **w** 的更新





- 过拟合：
    - 因为数据中会有不确定因素存在（即噪声），过度的训练会学习噪声，从而导致了过拟合
    - 模型阶次太高，会学会噪声，造成过拟合

- 欠拟合：训练不充分





- 噪声：
    - 数据量大，才能抵消噪声
        - 当数据量大的时候，对于没什么用的特征，其对应的 **w** 会趋向于 0
    - 数据量小，学出噪声





- 特征冗余
    - 两个特征具有比较强的相关性（例如，身高和体重）
    - 当特征出现冗余的时候，特征的重要程度会被稀释。所以不能只通过特征的权重大小来判断该特征的重要程度。





- 反相关：训练后，特征的权重是负数





- **MSE**：均方误差
    1. MSE适合线性回归的梯度下降算法
    2. 具有求解的便利性，保证有工程解
    3. 数学上的严格证明，理论的保证，MSE来源于噪声符合 **正态分布**
- **MAE**：平均绝对误差





- 为什么 **噪声** 要符合 **正态分布（也叫高斯分布）**
    1. 中心极限定理
    2. 正态分布是随机性最强的一种分布
        - 熵最大，最混乱
        - 比如猜随机数，正态分布最难猜





多项式回归





---







# 第三章 逻辑回归



逻辑回归是众多模型的基础，如 svm模型，fm模型，神经网络等。





分类任务





任何多分类，都可以简化成2分类





感知机：最早的分类模型（现在很少讲）

- 太硬
- 无法求导





逻辑函数

